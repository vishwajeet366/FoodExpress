{% extends "index.html" %}

{% block content %}
<div class="row justify-content-center">
    <div class="col-md-8">
        <div class="dashboard-card">
            <h2 class="text-center mb-4">
                <i class="fas fa-user-plus text-primary"></i> Create Account
            </h2>
            
            <form method="POST" action="{{ url_for('register') }}" id="registerForm" onsubmit="return validateForm()">
                <div class="row">
                    <div class="col-md-6">
                        <div class="form-group">
                            <label for="name">Full Name *</label>
                            <div class="input-group">
                                <div class="input-group-prepend">
                                    <span class="input-group-text"><i class="fas fa-user"></i></span>
                                </div>
                                <input type="text" class="form-control" id="name" name="name" 
                                       placeholder="Enter your full name" required>
                            </div>
                        </div>
                    </div>
                    
                    <div class="col-md-6">
                        <div class="form-group">
                            <label for="email">Email Address *</label>
                            <div class="input-group">
                                <div class="input-group-prepend">
                                    <span class="input-group-text"><i class="fas fa-envelope"></i></span>
                                </div>
                                <input type="email" class="form-control" id="email" name="email" 
                                       placeholder="Enter your email" required>
                            </div>
                        </div>
                    </div>
                </div>
                
                <div class="row">
                    <div class="col-md-6">
                        <div class="form-group">
                            <label for="phone">Phone Number</label>
                            <div class="input-group">
                                <div class="input-group-prepend">
                                    <span class="input-group-text"><i class="fas fa-phone"></i></span>
                                </div>
                                <input type="tel" class="form-control" id="phone" name="phone" 
                                       placeholder="Enter your phone number">
                            </div>
                        </div>
                    </div>
                    
                    <div class="col-md-6">
                        <div class="form-group">
                            <label for="role">Account Type *</label>
                            <div class="input-group">
                                <div class="input-group-prepend">
                                    <span class="input-group-text"><i class="fas fa-user-tag"></i></span>
                                </div>
                                <select class="form-control" id="role" name="role" required>
                                    <option value="customer">Customer</option>
                                    <option value="restaurant">Restaurant Owner</option>
                                    <option value="delivery">Delivery Partner</option>
                                </select>
                            </div>
                        </div>
                    </div>
                </div>
                
                <!-- Restaurant-specific fields (shown when role is restaurant) -->
                <div id="restaurantFields" style="display: none;">
                    <div class="row">
                        <div class="col-md-6">
                            <div class="form-group">
                                <label for="restaurant_name">Restaurant Name *</label>
                                <input type="text" class="form-control" id="restaurant_name" 
                                       name="restaurant_name" placeholder="Enter restaurant name">
                            </div>
                        </div>
                        <div class="col-md-6">
                            <div class="form-group">
                                <label for="cuisine_type">Cuisine Type</label>
                                <select class="form-control" id="cuisine_type" name="cuisine_type">
                                    <option value="">Select Cuisine</option>
                                    <option value="Indian">Indian</option>
                                    <option value="Chinese">Chinese</option>
                                    <option value="Italian">Italian</option>
                                    <option value="Mexican">Mexican</option>
                                    <option value="Fast Food">Fast Food</option>
                                    <option value="Multi-cuisine">Multi-cuisine</option>
                                </select>
                            </div>
                        </div>
                    </div>
                    <div class="form-group">
                        <label for="address">Restaurant Address</label>
                        <textarea class="form-control" id="address" name="address" 
                                  placeholder="Enter restaurant address" rows="2"></textarea>
                    </div>
                </div>
                
                <div class="row">
                    <div class="col-md-6">
                        <div class="form-group">
                            <label for="password">Password *</label>
                            <div class="input-group">
                                <div class="input-group-prepend">
                                    <span class="input-group-text"><i class="fas fa-lock"></i></span>
                                </div>
                                <input type="password" class="form-control" id="password" name="password" 
                                       placeholder="Create password" required minlength="8">
                            </div>
                            <small class="form-text text-muted">
                                Must be at least 8 characters
                            </small>
                        </div>
                    </div>
                    
                    <div class="col-md-6">
                        <div class="form-group">
                            <label for="confirm_password">Confirm Password *</label>
                            <div class="input-group">
                                <div class="input-group-prepend">
                                    <span class="input-group-text"><i class="fas fa-lock"></i></span>
                                </div>
                                <input type="password" class="form-control" id="confirm_password" 
                                       name="confirm_password" placeholder="Confirm password" required>
                            </div>
                            <small id="passwordMatch" class="form-text"></small>
                        </div>
                    </div>
                </div>
                
                <div class="form-group">
                    <div class="form-check">
                        <input class="form-check-input" type="checkbox" id="terms" required>
                        <label class="form-check-label" for="terms">
                            I agree to the <a href="#" class="text-primary">Terms & Conditions</a> and 
                            <a href="#" class="text-primary">Privacy Policy</a>
                        </label>
                    </div>
                </div>
                
                <button type="submit" class="btn btn-primary btn-block">
                    <i class="fas fa-user-plus"></i> Create Account
                </button>
            </form>
            
            <hr class="my-4">
            
            <div class="text-center">
                <p>Already have an account? 
                    <a href="{{ url_for('login') }}" class="text-primary">Login here</a>
                </p>
            </div>
        </div>
        
        <div class="dashboard-card mt-4">
            <h5><i class="fas fa-star text-warning"></i> Credit Score Benefits</h5>
            <div class="row">
                <div class="col-md-4">
                    <div class="text-center p-3">
                        <div class="credit-badge credit-trusted mb-2">90-100</div>
                        <h6>Trusted</h6>
                        <p class="small">20% Discount</p>
                    </div>
                </div>
                <div class="col-md-4">
                    <div class="text-center p-3">
                        <div class="credit-badge credit-good mb-2">75-89</div>
                        <h6>Good</h6>
                        <p class="small">15% Discount</p>
                    </div>
                </div>
                <div class="col-md-4">
                    <div class="text-center p-3">
                        <div class="credit-badge credit-average mb-2">50-74</div>
                        <h6>Average</h6>
                        <p class="small">10% Discount</p>
                    </div>
                </div>
            </div>
            <p class="text-center mt-3">
                <small>All new users start with a score of 70 (Average)</small>
            </p>
        </div>
    </div>
</div>

<script>
    // Show/hide restaurant fields based on role selection
    document.getElementById('role').addEventListener('change', function() {
        const restaurantFields = document.getElementById('restaurantFields');
        if (this.value === 'restaurant') {
            restaurantFields.style.display = 'block';
        } else {
            restaurantFields.style.display = 'none';
        }
    });
    
    // Password confirmation check
    document.getElementById('confirm_password').addEventListener('input', function() {
        const password = document.getElementById('password').value;
        const confirmPassword = this.value;
        const matchText = document.getElementById('passwordMatch');
        
        if (confirmPassword === '') {
            matchText.textContent = '';
            matchText.className = 'form-text';
        } else if (password === confirmPassword) {
            matchText.textContent = '✓ Passwords match';
            matchText.className = 'form-text text-success';
        } else {
            matchText.textContent = '✗ Passwords do not match';
            matchText.className = 'form-text text-danger';
        }
    });
    
    // Form validation
    function validateForm() {
        const password = document.getElementById('password').value;
        const confirmPassword = document.getElementById('confirm_password').value;
        const role = document.getElementById('role').value;
        const restaurantName = document.getElementById('restaurant_name')?.value;
        
        // Check password match
        if (password !== confirmPassword) {
            alert('Passwords do not match!');
            return false;
        }
        
        // Check password length
        if (password.length < 8) {
            alert('Password must be at least 8 characters long!');
            return false;
        }
        
        // Check restaurant fields if role is restaurant
        if (role === 'restaurant') {
            if (!restaurantName || restaurantName.trim() === '') {
                alert('Restaurant name is required for restaurant owners!');
                return false;
            }
        }
        
        // Check terms
        if (!document.getElementById('terms').checked) {
            alert('You must agree to the terms and conditions!');
            return false;
        }
        
        return true;
    }
</script>
{% endblock %}